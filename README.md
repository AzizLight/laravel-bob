working on a refactored version!